<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Johann Ostmeyer and Carsten Urbach" />


<title>qsimulatR</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">qsimulatR</h1>
<h3 class="subtitle">A Quantum Simulator in R</h3>
<h4 class="author">Johann Ostmeyer and Carsten Urbach</h4>
<h4 class="date">20. Dec. 2020</h4>



<div id="quantum-computing" class="section level1">
<h1>Quantum Computing</h1>
<p>Quantum computing is attracting a lot of attention recently due to significant advances in constructing quantum devices. While this does not yet mean that large scale quantum computing is possible, it might be so in the future. Thus, for the time being, quantum simulators play an important role for inventing and testing of algorithms.</p>
<p>Quantum computing requires a different approach to programming than many of us are used to on classical computers. The more or less standard approach is now via so-called <strong>quantum circuits</strong>, a generalisation of classical logical circuits (or better classical reversible circuits). The basic entity of such a circuit is a <strong>quantum state</strong> composed out of qubits. Such states can be manipulated via <strong>unitary quantum gates</strong>. Classical information can be retrieved by performing (projective) <strong>measurements</strong>.</p>
<p>For a comprehensive introduction and discussion see <span class="citation">(Nielsen and Chuang 2016)</span>.</p>
</div>
<div id="qsimulatr-package" class="section level1">
<h1>qsimulatR Package</h1>
<p>By the nature of quantum mechanics, quantum algorithms are probabilistic algorithms. As such, <code>R</code> could be the natural language to analyse the corresponding results. The package <code>qsimulatR</code> presented here provides a quantum simulator which allows one to implement quantum circuits in <code>R</code>. <code>qsimulatR</code> uses <code>S4</code> classes to implement quantum state manipulations intuitively via multiplications <code>*</code>.</p>
<p>General single qubit gates and general controlled single qubit gates can be easily defined. For convenience, it currently directly provides the most common gates (X, Y, Z, H, Z, S, T, Rx, Ry, Rz, CNOT, SWAP, toffoli or CCNOT, CSWAP). <code>qsimulatR</code> supports plotting of quantum circuits.</p>
<p>Since one important platform for real quantum devices is given by <code>qiskit</code>, <code>qsimulatR</code> is able to export circuits into <code>qiskit</code>. The such exported code can in principle be run directly on IBM’s real quantum hardware.</p>
<p>We have developed <code>qsimulatR</code> for a lecture on <em>Quantum Computing</em> taught at the University of Bonn, Germany, during winter term 2020. It is available on <a href="https://cran.r-project.org/">CRAN</a> since last week. The most up-to-date version can be obtained from the <code>github</code> <a href="https://github.com/HISKP-LQCD/qsimulatR">repository</a>.</p>
<div id="a-quantum-state" class="section level2">
<h2>A quantum state</h2>
<p>The basis for the simulator is a quantum state, called <code>qstate</code> in <code>qsimulatR</code> realised as an S4 class. One can generate a <code>qstate</code> with a number of qubits (here 2 by <code>nbits=2</code>) as follows</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(qsimulatR)</a>
<a class="sourceLine" id="cb1-2" title="2">x &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dt">nbits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">x</a></code></pre></div>
<pre><code>   ( 1 )    * |00&gt; </code></pre>
<p>Per default this state is in the computational basis with all qubits in the <span class="math inline">\(|0\rangle\)</span> state. The convention is that the least significant bit is printed as the rightmost qubit, the most significant one as the leftmost qubit. In front of the basis state the <em>complex</em> amplitude of this state is printed.</p>
<p>The basis state can also be supplied to <code>qstate</code> as an optional argument, e.g.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">CatInBox &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dt">nbits=</span><span class="dv">1</span>, <span class="dt">basis=</span><span class="kw">c</span>(<span class="st">&quot;|dead&gt;&quot;</span>, <span class="st">&quot;|alive&gt;&quot;</span>))</a>
<a class="sourceLine" id="cb3-2" title="2">CatInBox</a></code></pre></div>
<pre><code>   ( 1 )    * |dead&gt; </code></pre>
<p>and also the coefficients of the separate basis states can be set, even though that is not realistic on a real quantum device and should be avoided for other than testing purposes</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">CatInBox &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dt">nbits=</span><span class="dv">1</span>, <span class="dt">basis=</span><span class="kw">c</span>(<span class="st">&quot;|dead&gt;&quot;</span>, <span class="st">&quot;|alive&gt;&quot;</span>),</a>
<a class="sourceLine" id="cb5-2" title="2">                   <span class="dt">coefs=</span><span class="kw">as.complex</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb5-3" title="3">CatInBox</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |dead&gt; 
 + ( 0.7071068 )    * |alive&gt; </code></pre>
<p>Quantum circuits can be visualised very easily. Each qubit is represented by a horizontal line. In <code>qsimulatR</code> a circuit can be plotted by plotting a <code>qstate</code> object. If no gate was applied yet, the corresponding image is not very interesting</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">plot</span>(x, <span class="dt">qubitnames=</span><span class="kw">c</span>(<span class="st">&quot;qubit1&quot;</span>, <span class="st">&quot;qubit2&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA/FBMVEUAAAADAwMEBAQICAgJCQkMDAwNDQ0ODg4QEBAREREWFhYaGhohISEiIiIkJCQnJycrKys2NjY3Nzc4ODg8PDw+Pj5CQkJERERISEhQUFBTU1NYWFhcXFxdXV1gYGBhYWFqampubm5xcXFycnJzc3N0dHR1dXV2dnZ4eHh9fX2Dg4OKioqLi4uTk5OVlZWcnJygoKCkpKSsrKywsLCxsbG0tLS1tbW2tra6urq7u7u/v7/ExMTLy8vMzMzNzc3Ozs7Pz8/c3Nze3t7j4+Po6Ojq6urt7e3u7u7w8PDx8fHy8vL19fX39/f4+Pj5+fn7+/v8/Pz9/f3+/v7///9lzNvnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADWklEQVR4nO3a2Y4UZRiA4ZJdBRREkdVREdwRZRvAHcUFhaHu/17sUeIBdHgzSVV3JzzP0d/p5EvXm1RVOvmGkRca1v0DNp1AQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUJg60MGr4/jDvX+P29cnnr0WUwc6tz2O58/snnZOfDTx7LWY4xbbDfTzl28PAi1x5Or41jAMv906dWq/QEssAv169t37TxbH4wItsQj09Bkk0FIChRcGuru9Ab7b2wWtMtDOmdMbYGtvF+QWC3MEeu/Nbx+PAi23G+jO0UO/jwK9JAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQmG0F74uTB9/4/NHE09dgrhW8T4cPb3y875OJp6/BTCt4fx9+f3G4dODxDONXa6YVvO+H24sPXw8/TTx+9WZawXv441+LDx8ceDjx+NWbcf1lvLbv8sTT12C+QL9cGC56iz3n/0A3Xzv6zTPf7Rx7dQO8s7cLmivQzVe2nn/+/PFgA/y5twuaKdCj1y9MPHhdZlrBuz1c+WqXt9iznq7gfTb85/7E41fPn9UgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBT+AQUQj3g+2S48AAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="applying-single-qubit-gates" class="section level2">
<h2>Applying single qubit gates</h2>
<p>As said above, quantum states can be manipulated via unitary gates. For this the <code>*</code> operator is overloaded for certain types of gates applied to <code>qstate</code> objects. One important gate is the so-called <strong>Hadamard</strong> gate, which has the matrix representation <span class="math display">\[
H\ =\ \frac{1}{\sqrt{2}}\begin{pmatrix}
1 &amp; 1 \\
1 &amp; -1 \\
\end{pmatrix}\,.
\]</span> The Hadamard gate is available in <code>qsimulatR</code> as <code>H(j)</code>. Every single qubit gate needs to be supplied with the information <code>j</code> to which qubit it is to be applied to. The application to the first qubit (i.e. the least significant one) looks as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">x &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dt">nbits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">y &lt;-<span class="st"> </span><span class="kw">H</span>(<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb8-3" title="3">y</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |00&gt; 
 + ( 0.7071068 )    * |01&gt; </code></pre>
<p>In <code>R</code> we start counting with 1, which corresponds to the least significant bit (or the rightmost one in <span class="math inline">\(|00\rangle\)</span>). <code>H(1)</code> returns an S4 object of class <code>sqgate</code> and the multiplication with <code>qstate</code> is overloaded.</p>
<p>Now, with a gate included, plotting the state represents the quantum circuit used to generate the state, for instance</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">plot</span>(y)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAHBwcRERETExMaGhocHBwgICAiIiIwMDA9PT1CQkJERERMTExQUFBUVFRdXV1qampubm5/f3+CgoKLi4ukpKSsrKy0tLS7u7vExMTHx8fNzc3Pz8/Q0NDd3d3l5eXq6uru7u7y8vL19fX9/f3///8OoRkoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACxklEQVR4nO3a20obUQCG0XiosVpbT1V7UNuq7/+KYpD0ooxfcjNu6Fo3AwkMPx+zIQNZPPGmxXsPGJ1AQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgcKYgb4uJ32aecqYgc7P7iZ83595yqCBzqe+uRfohUBBoLAO9PlwdbldXL9+INCKQEGgIFD4XwN9u9nQl3Wgxat1oL1N7zHlx3ab5wz0eHK8oeU60MHVi8u/gXY2vceU0+1GO2JBoCBQECgIFAYP9A+BVgQKAgWBwsVy6nfwxw8zTxkz0K/pV6mfM08ZM9BABAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgMOs/zJa7AzjabvSsT9Cf3wN42G6zIxYECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUHgGSG2dn0acPoMAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>Even if there is a list of predefined standard single qubit gates (<code>H</code>, <code>X</code>, <code>Z</code>, <code>Y</code>, <code>Rz</code>, <code>Ry</code>, <code>Rz</code>, <code>Id</code>, <code>S</code>, <code>Tgate</code>), any single qubit gate can be defined as follows via its matrix representation</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">myGate &lt;-<span class="st"> </span><span class="cf">function</span>(bit) {</a>
<a class="sourceLine" id="cb11-2" title="2">  methods<span class="op">::</span><span class="kw">new</span>(<span class="st">&quot;sqgate&quot;</span>, <span class="dt">bit=</span><span class="kw">as.integer</span>(bit),</a>
<a class="sourceLine" id="cb11-3" title="3">               <span class="dt">M=</span><span class="kw">array</span>(<span class="kw">as.complex</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>)), <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb11-4" title="4">               <span class="dt">type=</span><span class="st">&quot;myGate&quot;</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">}</a></code></pre></div>
<p>From now on this gate can be used like the predefined ones</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">z &lt;-<span class="st"> </span><span class="kw">myGate</span>(<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb12-2" title="2">z</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |00&gt; 
 + ( -0.7071068 )   * |01&gt; </code></pre>
<p>The argument <code>M</code> must be a unitary <span class="math inline">\(2\times 2\)</span> complex valued matrix, which in this case is the third Pauli matrix predefined as <code>Z</code>. If <code>M</code> is not unitary, an error will the thrown.</p>
<div id="truth-table" class="section level3">
<h3>Truth Table</h3>
<p>Sometimes it is useful to look at the quantum analogue of a truth table of a gate as it immediately shows how every qubit is influenced depending on the other qubits. It can provide a consistency check for a newly implemented gate, too. The truth table of a single qubit gate (here the <code>X</code> gate) can be obtained as follows</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">truth.table</span>(X, <span class="dv">1</span>)</a></code></pre></div>
<pre><code>  In1 Out1
1   0    1
2   1    0</code></pre>
</div>
</div>
<div id="multi-qubit-gates" class="section level2">
<h2>Multi-qubit gates</h2>
<p>For universal quantum computing more than single qubit gates are necessary. The most important two-qubit gate is the controlled <code>NOT</code> or <code>CNOT</code> gate. It has the truth table</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">truth.table</span>(CNOT, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>  In2 In1 Out2 Out1
1   0   0    0    0
2   0   1    1    1
3   1   0    1    0
4   1   1    0    1</code></pre>
<p>and can for instance be used as follows to generate a Bell state</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">z &lt;-<span class="st"> </span><span class="kw">CNOT</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb18-2" title="2">z</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |00&gt; 
 + ( 0.7071068 )    * |11&gt; </code></pre>
<p>which is maximally entangled. Plotting the resulting circuit looks as follows</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">plot</span>(z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The arguments to <code>CNOT</code> are the control and target bit in this order. Again, arbitrary controlled single qubit gates can be generated as follows</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">CX12 &lt;-<span class="st"> </span><span class="kw">cqgate</span>(<span class="dt">bits=</span><span class="kw">c</span>(1L, 2L), <span class="dt">gate=</span><span class="kw">X</span>(2L))</a>
<a class="sourceLine" id="cb21-2" title="2">z &lt;-<span class="st"> </span>CX12 <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb21-3" title="3">z</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |00&gt; 
 + ( 0.7071068 )    * |11&gt; </code></pre>
<p>which in this case is the <code>CNOT</code> gate again with control bit 1 and target bit 2. <code>cqgate</code> is a convenience function to generate a new S4 object of S4 class <code>cqgate</code>. Note that a similar function <code>sqgate</code> for single qubit gates is available. The <code>gate</code> argument to <code>cqgate</code> can be any <code>sqgate</code> object.</p>
<p>Another widely used two-qubit gate is the <code>SWAP</code> gate, which swaps two qubits, in the following example the first and the second qubit:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">z &lt;-<span class="st"> </span><span class="kw">SWAP</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb23-2" title="2">z</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |00&gt; 
 + ( 0.7071068 )    * |10&gt; </code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">plot</span>(z)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA/FBMVEUAAAAEBAQMDAwNDQ0REREWFhYYGBgaGhobGxsdHR0gICAhISEiIiIjIyMmJiYnJycpKSktLS0uLi4vLy8wMDA4ODg6Ojo8PDw/Pz9AQEBCQkJERERJSUlNTU1PT09QUFBSUlJUVFRXV1dcXFxeXl5oaGhqamptbW1vb29zc3N7e3t9fX1/f3+KioqLi4uSkpKTk5OWlpadnZ2kpKSoqKisrKyxsbGysrK0tLS2tra3t7e7u7vBwcHFxcXJycnKysrNzc3Q0NDS0tLU1NTW1tbX19fY2Njd3d3g4ODk5OTl5eXn5+fr6+vu7u719fX4+Pj5+fn6+vr7+/v///9YuRv5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEH0lEQVR4nO3aaVcScRSAcUqzMlstK0vby7J939MWMyvT+P7fJVl1EHzAuOD1PM8bcGDwnt85M/MfDqWy7Vhp2APs9QSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIKGCfR4omM3hjhWsWEC3bn/vUNvTu+0399vrVvWl8KGHCrQo06vfN4R6Meh18UNazO3+jNRmzIClRfGXm79c2326nqfRtpeSqCiUKjP3gC6drb6sFhqHDoEtFUo1icr0KZQsE9aoIZQtE9eoJpQuE9ioIpQvM9ggBbfte1KE6hUrwl0rP0exZ6MTpx/280bCy30NvtAgOYute1oE2j8RaWHm0AH2+9RbHqkNNnN+4rd7m32xIfY2uyFM8UVY0R5gTbOP++nFsKF0gJVzs8fplrvOvpfVqDq9WsDKFwoKVDt+l4BihbaE0DbIqD6+qcKFCyUEqixPqwBxQplBFqfqa+f60Dlj63foPWxjEArd+v3Fw2g8qcHfRuqtWECzZ3stNo9N9nVBzSBAhsm0ErnG6YvXX3Afgf67wSCBIIEggSCBIIEggSCBIIEggSCBIIEggRq3/LFX7UnTaBn+/MXZrtu/tTP6mMD6Pnh7r4e2U0pgRpCdaBIn6RAdaEaUKhPVqCaUBUo1ictUFWoAhTskxeoIrQBFO2TGGhD6NVUuE9moPL8+PFwn8EAXR6N6UBppPedpnubfSBAq79Dejp288RSz3ut9jZ74kOscv5prKnjygtUOz+HC6UFaly/ooWyAm1e34OFkgJtXf/ECuUEKq4PQ4VSArWunyOFMgItH/nasuXe9bB/lhGo/KeLLf0qJdAgEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCPoH6/Fo0/4Dq/QAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>The order of the bits supplied to <code>SWAP</code> is irrelevant, of course</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">z &lt;-<span class="st"> </span><span class="kw">SWAP</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb26-2" title="2">z</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |00&gt; 
 + ( 0.7071068 )    * |10&gt; </code></pre>
<p>Finally, there are also the controlled <code>CNOT</code> or Toffoli gate and the controlled <code>SWAP</code> or Fredkin gate available. The next code snipped shows the application of the <code>CCNOT</code> gate.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">x &lt;-<span class="st"> </span><span class="kw">H</span>(<span class="dv">1</span>) <span class="op">*</span>(<span class="kw">H</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw">qstate</span>(<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb28-2" title="2">x</a></code></pre></div>
<pre><code>   ( 0.5 )  * |000&gt; 
 + ( 0.5 )  * |001&gt; 
 + ( 0.5 )  * |010&gt; 
 + ( 0.5 )  * |011&gt; </code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">y &lt;-<span class="st"> </span><span class="kw">CCNOT</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb30-2" title="2">y</a></code></pre></div>
<pre><code>   ( 0.5 )  * |000&gt; 
 + ( 0.5 )  * |001&gt; 
 + ( 0.5 )  * |010&gt; 
 + ( 0.5 )  * |111&gt; </code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">plot</span>(y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The arguments to <code>CCNOT</code> is a vector of three integers. The first two integers are the control bits, the last one the target bit.</p>
<p>Similarly, the <code>CSWAP</code> or Fredkin gate</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">y &lt;-<span class="st"> </span><span class="kw">CSWAP</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb33-2" title="2">y</a></code></pre></div>
<pre><code>   ( 0.5 )  * |000&gt; 
 + ( 0.5 )  * |001&gt; 
 + ( 0.5 )  * |010&gt; 
 + ( 0.5 )  * |101&gt; </code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">plot</span>(y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="multi-gate-circuits-as-functions" class="section level2">
<h2>Multi-gate circuits as functions</h2>
<p>You might want to use specific circuits of several gates more than once and therefore find it tedious to type it completely every time you use it. Defining a new gate combining all of the operations might not be as easy either. In these cases we find it convenient to define generating functions of the form</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">myswap &lt;-<span class="st"> </span><span class="cf">function</span>(bits){</a>
<a class="sourceLine" id="cb36-2" title="2">    <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb36-3" title="3">        <span class="kw">CNOT</span>(bits) <span class="op">*</span><span class="st"> </span>(<span class="kw">CNOT</span>(<span class="kw">rev</span>(bits)) <span class="op">*</span><span class="st"> </span>(<span class="kw">CNOT</span>(bits) <span class="op">*</span><span class="st"> </span>x))</a>
<a class="sourceLine" id="cb36-4" title="4">    }</a>
<a class="sourceLine" id="cb36-5" title="5">}</a></code></pre></div>
<p>where an outer function takes any required information concerning the circuit. It then returns a function that applies given circuit to a state.</p>
<p>Our example above implements a <code>SWAP</code> using only <code>CNOT</code> gates as can be checked with the truth table:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">truth.table</span>(myswap, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>  In2 In1 Out2 Out1
1   0   0    0    0
2   0   1    1    0
3   1   0    0    1
4   1   1    1    1</code></pre>
<p>We can plot the circuit in the way we are used to as well.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">circuit &lt;-<span class="st"> </span><span class="kw">myswap</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">plot</span>(<span class="kw">circuit</span>(<span class="kw">qstate</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="measurements" class="section level2">
<h2>Measurements</h2>
<p>At any point single qubits can be measured</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">res &lt;-<span class="st"> </span><span class="kw">measure</span>(y, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">summary</span>(res)</a></code></pre></div>
<pre><code>Bit 1 has been measured 1 times with the outcome:
0:  1 
1:  0 </code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">plot</span>(res<span class="op">$</span>psi)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In this case the third qubit is <em>measured</em> and its value is stored in <code>res$value</code>. The wave function of the quantum state collapses, the result of which is stored again as a <code>qstate</code> object in <code>res$psi</code>.</p>
<p>Such a measurement can be repeated, say 1000 times, for qubit 3</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">rv &lt;-<span class="st"> </span><span class="kw">measure</span>(y, <span class="dv">3</span>, <span class="dt">rep=</span><span class="dv">1000</span>)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">hist</span>(rv, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">&quot;Probability for Qubit 3&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>where we read of from the wave function that the ratio should be <span class="math inline">\(3:1\)</span> for values <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, which is well reproduced.</p>
</div>
<div id="quantum-fourier-trafo-and-other-higher-level-functionality" class="section level2">
<h2>Quantum Fourier Trafo and other higher level functionality</h2>
<p>The quantum Fourier transformation (qFT) is an important building block of many algorithms. <code>qsimulatR</code> provides an implementation of qFT over <span class="math inline">\(\mathbb{Z}_{2^n}\)</span> via the <code>qft</code> function.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">y &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb44-2" title="2">y &lt;-<span class="st"> </span><span class="kw">qft</span>(y, <span class="dt">inverse=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb44-3" title="3"><span class="kw">plot</span>(y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><code>qft</code> can also apply the inverse qFT by setting <code>inverse=TRUE</code>. Moreover, the qFT can also be applied to a subset of qubits only, here to qubits two to four while the first qubit is left alone:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">y &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb45-2" title="2">y &lt;-<span class="st"> </span><span class="kw">qft</span>(y, <span class="dt">bits=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">inverse=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb45-3" title="3"><span class="kw">plot</span>(y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>For more details we refer to the <code>qft</code> vignette. Based on the qFT algorithm the <strong>phase estimation</strong> algorithm can be defined. It is implemented in <code>qsimulatR</code> as the function <code>phase_estimation</code>. The phase estimation allows to estimate the phase of eigenvalues of unitary operators (all eigenvalues <span class="math inline">\(\lambda=e^{2\pi i\varphi}\)</span> of unitary operators <span class="math inline">\(U\)</span> have modulus 1, i.e. <span class="math inline">\(|\lambda| = 1\)</span>). In order to call the <code>phase_estimation</code> function, a wrapper function for the unitary operator needs to be defined, e.g. for the <code>NOT</code> operator, which is the Pauli <code>X</code> matrix <span class="math display">\[
X\ =\ \begin{pmatrix}
0 &amp; 1 \\
1 &amp; 0 \\
\end{pmatrix}
\]</span> The wrapper function then needs to implement a controlled <code>NOT</code> operation, i.e. the <code>CNOT</code> operator, to the power <span class="math inline">\(2^j\)</span>. <span class="math inline">\(X^2=1\)</span>, thus we can implement it as follows</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">cnotwrapper &lt;-<span class="st"> </span><span class="cf">function</span>(c, j, x, k) {</a>
<a class="sourceLine" id="cb46-2" title="2">  <span class="cf">if</span>(j <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">return</span>(<span class="kw">CNOT</span>(<span class="kw">c</span>(c, k)) <span class="op">*</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb46-3" title="3">  <span class="kw">return</span>(<span class="kw">Id</span>(k) <span class="op">*</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb46-4" title="4">}</a></code></pre></div>
<p>For the <code>phase_estimation</code> function, this wrapper function must have the control qubit <code>c</code> as first argument, as the second the integer power <code>j</code> and as the third the <code>qstate</code> object <code>x</code>. Additional parameters to the wrapper function can be passed via the <code>...</code> argument to <code>phase_estimation</code>.</p>
<p><code>X</code> has eigenvalues <span class="math inline">\(\lambda_\pm=\pm1\)</span>. Thus, the corresponding phases are <span class="math inline">\(\varphi = 0\)</span> and <span class="math inline">\(\varphi= 1/2\)</span>. Both can be represented as binary fractions with a single bit exactly. Here we use <span class="math inline">\(t=2\)</span> qubits in the call of <code>phase_estimation</code> determined by the length of the <code>bitmask</code> argument to the function. In addition, the phase estimation procedure needs a trial state. If possible, this trial state should be in an eigenstate of the unitary operator. However, also a random superposition of eigenstates works. In the example, we use the first qubit as the trial state, which we initialise in the state <span class="math inline">\((|0\rangle + |1\rangle)/\sqrt{2}\)</span>, which is an eigenstate of <span class="math inline">\(X\)</span> with eigenvalue <span class="math inline">\(+1\)</span>. Qubits two and three are used in the phase estimation function</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">x &lt;-<span class="st"> </span><span class="kw">H</span>(<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">qstate</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb47-2" title="2">x &lt;-<span class="st"> </span><span class="kw">phase_estimation</span>(<span class="dt">bitmask=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">FUN=</span>cnotwrapper, <span class="dt">x=</span>x, <span class="dt">k=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb47-3" title="3">x</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |000&gt; 
 + ( 0.7071068 )    * |001&gt; </code></pre>
<p>How to interpret the result? The first qubit stays in the state <span class="math inline">\((|0\rangle + |1\rangle)/\sqrt{2}\)</span>, as it is an eigenstate. The other two qubits encode the phase <span class="math inline">\(\varphi=0.00\)</span> in binary fraction representation. Using the other eigenstate <span class="math inline">\((|0\rangle - |1\rangle)/\sqrt{2}\)</span> leads to</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">x &lt;-<span class="st"> </span><span class="kw">H</span>(<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">X</span>(<span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">qstate</span>(<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb49-2" title="2">x &lt;-<span class="st"> </span><span class="kw">phase_estimation</span>(<span class="dt">bitmask=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">FUN=</span>cnotwrapper, <span class="dt">x=</span>x, <span class="dt">k=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb49-3" title="3">x</a></code></pre></div>
<pre><code>   ( 0.7071068 )    * |100&gt; 
 + ( -0.7071068 )   * |101&gt; </code></pre>
<p>and <span class="math inline">\(\varphi=0.10 = 1/2\)</span>. More details and a more complex example can be found in the <code>qsimulatR</code> vignette on <code>phase_estimation</code>.</p>
</div>
</div>
<div id="quantum-noise" class="section level1">
<h1>Quantum Noise</h1>
<p>Current quantum hardware is noisy. <code>qsimulatR</code> offers possibilities to simulate such noise. First of all, there is a noisy gate with different noise models. With a certain probability <code>p</code> (default value <code>1</code>) a gate is applied to qubit <code>bit</code>, which can follow the models <code>X</code>, <code>Y</code>, <code>Z</code>, <code>small</code> or <code>any</code>:</p>
<ul>
<li><code>X</code>, <code>Y</code> or <code>Z</code> are the corresponding Pauli gates</li>
<li>in case of <code>small</code>, an almost unit gate is applied with a small deviation parametrised by and additional parameter <code>sigma</code> representing the standard deviation of Gaussian noise</li>
<li><code>any</code> means an arbitrary, uniformly sampled, SU(2)-matrix is applied</li>
</ul>
<p>Examples are</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">x &lt;-<span class="st"> </span><span class="kw">noise</span>(<span class="dt">bit=</span><span class="dv">1</span>, <span class="dt">error=</span><span class="st">&quot;X&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="kw">qstate</span>(<span class="dt">nbits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb51-2" title="2">x</a></code></pre></div>
<pre><code>   ( 1 )    * |01&gt; </code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">y &lt;-<span class="st"> </span><span class="kw">noise</span>(<span class="dt">bit=</span><span class="dv">2</span>, <span class="dt">p=</span><span class="fl">0.5</span>) <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb53-2" title="2">y</a></code></pre></div>
<pre><code>   ( 0.5139376+0.0725443i ) * |01&gt; 
 + ( 0.8542451-0.0295094i ) * |11&gt; </code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">z &lt;-<span class="st"> </span><span class="kw">noise</span>(<span class="dt">bit=</span><span class="dv">2</span>, <span class="dt">error=</span><span class="st">&quot;small&quot;</span>, <span class="dt">args=</span><span class="kw">list</span>(<span class="dt">sigma=</span><span class="fl">0.1</span>)) <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb55-2" title="2">z</a></code></pre></div>
<pre><code>   ( 0.9848509+0.1627725i ) * |01&gt; 
 + ( -0.04433343-0.04010527i )  * |11&gt; </code></pre>
<p>This is generalised to a quantum state in <code>qsimulatR</code> by making it a property of a <code>state</code> as follows:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">x &lt;-<span class="st"> </span><span class="kw">qstate</span>(<span class="dt">nbits=</span><span class="dv">2</span>, <span class="dt">noise=</span><span class="kw">genNoise</span>(<span class="dt">nbits=</span><span class="dv">2</span>, <span class="dt">p=</span><span class="dv">1</span>, <span class="dt">error=</span><span class="st">&quot;any&quot;</span>))</a></code></pre></div>
<p>Now, a random gate is applied with every gate applied to such a quantum state, e.g.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">y &lt;-<span class="st"> </span><span class="kw">Id</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb58-2" title="2">y</a></code></pre></div>
<pre><code>   ( 0.5140889+0.8017019i ) * |00&gt; 
 + ( -0.0753246+0.2954876i )    * |10&gt; </code></pre>
<p>See the function <code>genNoise</code> for more details.</p>
</div>
<div id="export-to-qiskit" class="section level1">
<h1>Export to Qiskit</h1>
<p>IBM provides quantum computing platforms, which can be freely used. However, one needs to programme in python using the <code>qiskit</code> package. For convenience, <code>qsimulatR</code> can export a circuit translated to <code>qiskit</code></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">filename &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;/circuit.py&quot;</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">export2qiskit</span>(y, <span class="dt">filename=</span>filename, <span class="dt">import=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>Warning in export2qiskit(y, filename = filename, import = TRUE): Gate of type
&#39;Id&#39; is not supported!</code></pre>
<pre><code>Warning in export2qiskit(y, filename = filename, import = TRUE): Gate of type
&#39;ERR&#39; is not supported!</code></pre>
<p>which results in the following file</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">cat</span>(<span class="kw">readLines</span>(filename), <span class="dt">sep =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code># automatically generated by qsimulatR
import numpy as np
from qiskit import(QuantumCircuit, execute, Aer)
from qiskit.visualization import plot_histogram
simulator = Aer.get_backend(&#39;qasm_simulator&#39;)
qc = QuantumCircuit(2)
# qc.Id(1) ## WARNING: Not properly exported, interpret as pseudocode!
# qc.ERR(1) ## WARNING: Not properly exported, interpret as pseudocode!</code></pre>
<p>which can be used at <a href="https://quantum-computing.ibm.com">quantum-computing.ibm.com</a> to run on real quantum hardware. Note that the export functionality only works for standard quantum gates, not for customary defined ones.</p>
</div>
<div id="bibliography" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-nielsenchuan">
<p>Nielsen, M. A., and I. L. Chuang. 2016. <em>Quantum Computation and Quantum Information</em>. 10th ed. Cambridge University Press.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
